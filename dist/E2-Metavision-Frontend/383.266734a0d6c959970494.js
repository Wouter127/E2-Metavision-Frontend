"use strict";(self.webpackChunke2_metavision_frontend=self.webpackChunke2_metavision_frontend||[]).push([[383],{3383:(V,_,a)=>{a.r(_),a.d(_,{OrganisatiebeheerderRoutingModule:()=>P});var p=a(4571),u=a(5319),e=a(3018),h=a(8011),x=a(5327),d=a(8583),g=a(665);function b(t,s){1&t&&(e.TgZ(0,"span"),e._uU(1," Activatiecode is veplicht. "),e.qZA())}function w(t,s){if(1&t&&(e.TgZ(0,"div",19),e.YNc(1,b,2,0,"span",20),e.qZA()),2&t){e.oxw();const n=e.MAs(17);e.xp6(1),e.Q6J("ngIf",null==n.errors?null:n.errors.required)}}function Z(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div",2),e.TgZ(1,"div",3),e.TgZ(2,"div",4),e.TgZ(3,"div",5),e.TgZ(4,"h3",6),e._uU(5),e.qZA(),e.TgZ(6,"button",7),e.NdJ("click",function(){return e.CHM(n),e.oxw().closeModal()}),e.TgZ(7,"span",8),e._uU(8," \xd7 "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",9),e.TgZ(10,"form",10,11),e.NdJ("ngSubmit",function(){return e.CHM(n),e.oxw().onSubmit()}),e.TgZ(12,"div",12),e.TgZ(13,"div"),e.TgZ(14,"label",13),e._uU(15,"Activatiecode"),e.qZA(),e.TgZ(16,"input",14,15),e.NdJ("ngModelChange",function(o){return e.CHM(n),e.oxw().uniekeCode=o}),e.qZA(),e.YNc(18,w,2,1,"div",16),e.qZA(),e.qZA(),e.TgZ(19,"div",17),e.TgZ(20,"button",18),e._uU(21," Toevoegen "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const n=e.MAs(11),i=e.MAs(17),o=e.oxw();e.xp6(5),e.hij(" ",o.title," "),e.xp6(11),e.Q6J("ngModel",o.uniekeCode),e.xp6(2),e.Q6J("ngIf",i.invalid&&(i.dirty||i.touched)),e.xp6(2),e.Q6J("disabled",!n.form.valid)}}function A(t,s){1&t&&e._UZ(0,"div",21)}let f=(()=>{class t{constructor(n,i,o){this.router=n,this.weerstationService=i,this.toast=o,this.output=new e.vpe,this.showModal=!1,this.uniekeCode="",this.activeerWeerstation$=new u.w,this.toast.defaultConfig=Object.assign(Object.assign({},this.toast.defaultConfig),{reverseOrder:!0})}ngOnInit(){}ngOnDestroy(){this.activeerWeerstation$.unsubscribe()}openModal(){this.showModal=!0}closeModal(){this.showModal=!1}onSubmit(){this.activeerWeerstation$=this.weerstationService.activeerWeerstation(this.uniekeCode).pipe(this.toast.observe({loading:{content:"Toevoegen...",position:"bottom-right"},success:{content:"Weerstation toegevoegd!",position:"bottom-right",dismissible:!0},error:{content:n=>{let i="<ul>";i+="<li><b>Er ging iets mis!</b></li>",i+="<li>Controleer of de activatiecode correct is.</li>";for(let o in n.error.errors)i+=`<li>${n.error.errors[o]}</li>`;return i+="</ul>",i},position:"bottom-right",dismissible:!0,duration:5e3}})).subscribe(n=>{this.uniekeCode="",this.closeModal(),this.output.next()})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(p.F0),e.Y36(h.W),e.Y36(x.jE))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-weerstations-activeren"]],inputs:{title:"title"},outputs:{output:"output"},decls:2,vars:2,consts:[["class","overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none justify-center items-center flex mx-4",4,"ngIf"],["class","opacity-25 fixed inset-0 z-40 bg-black",4,"ngIf"],[1,"overflow-x-hidden","overflow-y-auto","fixed","inset-0","z-50","outline-none","focus:outline-none","justify-center","items-center","flex","mx-4"],[1,"relative","my-6","mx-auto","max-w-6xl","w-11/12","sm:w-9/12","md:w-7/12","lg:w-5/12"],[1,"border-0","rounded-lg","shadow-lg","relative","flex","flex-col","w-full","bg-white","outline-none","focus:outline-none"],[1,"flex","items-start","justify-between","p-5","border-b","border-solid","border-blueGray-200","rounded-t"],[1,"text-3xl","font-semibold"],[1,"p-1","ml-auto","bg-transparent","border-0","text-black","opacity-50","float-right","text-3xl","leading-none","font-semibold","outline-none","focus:outline-none",3,"click"],[1,"bg-transparent","text-black","opacity-50","h-6","w-6","text-2xl","block","outline-none","focus:outline-none"],[1,"relative","p-6","flex-auto"],[3,"ngSubmit"],["organisatieBeheerderUitnodigenForm","ngForm"],[1,"bg-white"],["for","uniekeCode",1,"block","font-medium","text-gray-700"],["type","text","name","uniekeCode","id","uniekeCode","required","",1,"mt-1","p-2","focus:ring-wbRed-500","border","focus:border-wbRed-500","block","w-full","shadow-sm","sm:text-sm","border-gray-300","rounded-md",3,"ngModel","ngModelChange"],["activatieCode","ngModel"],["class","text-xs text-red-500 font-medium",4,"ngIf"],[1,"px-4","py-3","text-center","sm:px-6"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","font-medium","rounded-md","text-white","bg-wbRed-600","hover:bg-wbRed-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-wbRed-500","disabled:bg-gray-400","disabled:cursor-not-allowed",3,"disabled"],[1,"text-xs","text-red-500","font-medium"],[4,"ngIf"],[1,"opacity-25","fixed","inset-0","z-40","bg-black"]],template:function(n,i){1&n&&(e.YNc(0,Z,22,4,"div",0),e.YNc(1,A,1,0,"div",1)),2&n&&(e.Q6J("ngIf",i.showModal),e.xp6(1),e.Q6J("ngIf",i.showModal))},directives:[d.O5,g._Y,g.JL,g.F,g.Fj,g.Q7,g.JJ,g.On],styles:[""]}),t})();var T=a(2770),C=a(3496),M=a(218),y=a(7080),O=a(8270),W=a(6017);const v=function(){return{placement:"right",hideDelay:20}};function q(t,s){1&t&&(e.TgZ(0,"span",32),e._uU(1,"Publiek zichtbaar"),e.qZA()),2&t&&e.Q6J("options",e.DdM(1,v))}function k(t,s){1&t&&(e.TgZ(0,"span",33),e._uU(1," Niet publiek zichtbaar "),e.qZA()),2&t&&e.Q6J("options",e.DdM(1,v))}function U(t,s){1&t&&(e.ynx(0),e.TgZ(1,"div"),e._UZ(2,"i",35),e.qZA(),e.BQk())}function L(t,s){1&t&&(e.TgZ(0,"span",39),e._uU(1," Aan "),e.qZA())}function I(t,s){1&t&&(e.TgZ(0,"span",40),e._uU(1," Uit "),e.qZA())}function S(t,s){if(1&t&&(e.TgZ(0,"p"),e.TgZ(1,"span",36),e._uU(2,"Datum:"),e.qZA(),e._uU(3),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"p"),e.TgZ(6,"span",36),e._uU(7,"Locatie:"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"p"),e.TgZ(10,"span",36),e._uU(11,"Status:"),e.qZA(),e.YNc(12,L,2,0,"span",37),e.YNc(13,I,2,0,"ng-template",null,38,e.W1O),e.qZA()),2&t){const n=e.MAs(14),i=e.oxw(2).$implicit;e.xp6(3),e.Oqu(e.xi3(4,4,i.laatsteMeting.time,"d/W/yyyy HH:mm:ss")),e.xp6(5),e.Oqu(i.laatsteMeting.location),e.xp6(4),e.Q6J("ngIf",1===i.laatsteMeting.sw1)("ngIfElse",n)}}function R(t,s){if(1&t&&(e.ynx(0),e.YNc(1,U,3,0,"ng-container",3),e.YNc(2,S,15,7,"ng-template",null,34,e.W1O),e.BQk()),2&t){const n=e.MAs(3),i=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","loading"===i.laatsteMeting)("ngIfElse",n)}}function Y(t,s){1&t&&(e.TgZ(0,"p"),e._uU(1,"Dit weerstation heeft nog geen metingen."),e.qZA())}const J=function(t){return{"bg-wbRed-500":t}},N=function(){return{unchecked:"#DDDEE3",checked:"#6C9A8B"}},Q=function(){return{placement:"bottom",hideDelay:20}};function j(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div",17),e.TgZ(1,"div",18),e.TgZ(2,"ng-toggle",19),e.NdJ("change",function(){const r=e.CHM(n).$implicit;return e.oxw(3).toggleRelais(r.id)}),e.qZA(),e.qZA(),e.TgZ(3,"div",20),e.TgZ(4,"h3",21),e._uU(5),e.TgZ(6,"a",22),e._UZ(7,"i",23),e.qZA(),e.qZA(),e.TgZ(8,"div"),e.YNc(9,q,2,2,"span",24),e.YNc(10,k,2,2,"ng-template",null,25,e.W1O),e._UZ(12,"hr",26),e.TgZ(13,"p"),e.TgZ(14,"span",27),e._uU(15,"Laatste gegevens:"),e.qZA(),e.qZA(),e.YNc(16,R,4,2,"ng-container",3),e.YNc(17,Y,2,0,"ng-template",null,28,e.W1O),e.qZA(),e.TgZ(19,"p",29),e.TgZ(20,"a",30),e.TgZ(21,"span"),e._uU(22,"Toon metingen"),e.qZA(),e._UZ(23,"i",31),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const n=s.$implicit,i=e.MAs(11),o=e.MAs(18);e.xp6(1),e.Q6J("ngClass",e.VKq(11,J,1===n.isRelaisManueelAan)),e.xp6(1),e.Q6J("value",1===n.isRelaisManueelAan)("color",e.DdM(13,N))("options",e.DdM(14,Q)),e.xp6(3),e.hij("",n.naam," "),e.xp6(1),e.MGl("href","organisatiebeheerder/waardes/",n.id,"",e.LSH),e.xp6(3),e.Q6J("ngIf",n.isPubliekZichtbaar)("ngIfElse",i),e.xp6(7),e.Q6J("ngIf",n.laatsteMeting)("ngIfElse",o),e.xp6(4),e.MGl("href","weerstation/",n.id,"/dashboard",e.LSH)}}function E(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"div",6),e.TgZ(2,"div",7),e.TgZ(3,"div"),e.TgZ(4,"h2",8),e._uU(5),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"div",9),e.TgZ(7,"div",10),e._UZ(8,"input",11),e.TgZ(9,"button",12),e.O4$(),e.TgZ(10,"svg",13),e._UZ(11,"path",14),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.kcU(),e.TgZ(12,"div",15),e.YNc(13,j,24,15,"div",16),e.qZA(),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(5),e.hij(" Weerstations van ",n.organisatie.naam,""),e.xp6(8),e.Q6J("ngForOf",n.organisatie.weerstations)}}function D(t,s){1&t&&(e.TgZ(0,"h2"),e._uU(1,"Uw account is geen lid van een organiastie"),e.qZA())}function F(t,s){if(1&t&&(e.ynx(0),e.YNc(1,E,14,2,"ng-container",3),e.YNc(2,D,2,0,"ng-template",null,5,e.W1O),e.BQk()),2&t){const n=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.organisatie)("ngIfElse",n)}}function $(t,s){1&t&&e._UZ(0,"div",45)}const z=function(){return[1,2,3,4]};function G(t,s){1&t&&(e.TgZ(0,"div",6),e.TgZ(1,"div",7),e._UZ(2,"div",41),e.qZA(),e.TgZ(3,"div",9),e.TgZ(4,"div",42),e._UZ(5,"div",43),e.qZA(),e.qZA(),e.TgZ(6,"div",15),e.YNc(7,$,1,0,"div",44),e.qZA(),e.qZA()),2&t&&(e.xp6(7),e.Q6J("ngForOf",e.DdM(1,z)))}let B=(()=>{class t{constructor(n,i,o,r,l,c){this.authService=n,this.authStateService=i,this.organisatieService=o,this.weerstationService=r,this.locationService=l,this.toast=c,this.loading=!0,this.organisatie$=new u.w,this.getLaatsteMeting$=new u.w,this.getReverseGeocoding$=new u.w,this.toast.defaultConfig=Object.assign(Object.assign({},this.toast.defaultConfig),{reverseOrder:!0})}ngOnInit(){this.getOrganisatie()}weerstationActiveren(){this.weerstationActiverenComponent.openModal(),this.weerstationActiverenComponent.output.subscribe(()=>{this.ngOnInit()})}toggleRelais(n){console.log("toggle clicked");let i=this.organisatie.weerstations.find(o=>o.id===n);i&&(i.isRelaisManueelAan=i.isRelaisManueelAan?0:1,this.weerstationService.putWeerstationOrganisatieBeheerder(n,i).pipe(this.toast.observe({loading:{content:"Schakelen...",position:"bottom-right"},success:{content:"Relais geschakeld! Het duurt maximaal 1 minuut voordat de configuratie is doorgevoerd.",position:"bottom-right",dismissible:!0},error:{content:o=>{let r="<ul>";r+="<li><b>Er ging iets mis!</b></li>";for(let l in o.error.errors)r+=`<li>${o.error.errors[l]}</li>`;return r+="</ul>",r},position:"bottom-right",dismissible:!0,duration:5e3}})).subscribe(o=>{console.log(o)}))}getOrganisatie(){this.authStateService.gebruikerAuthState.subscribe(n=>{n?this.authService.getGebruiker().subscribe(i=>{this.gebruiker=i,this.organisatie$=this.organisatieService.getOrganisatieWithWeerstations(i.organisatieId).subscribe(o=>{let r=o;r.weerstations.map(l=>l.laatsteMeting="loading"),this.organisatie=r,this.loading=!1,r.weerstations.forEach(l=>{this.getLaatsteMeting$=this.weerstationService.getLaatsteMeting(l.id).subscribe(c=>{c?(r.weerstations.find(m=>m.id===l.id).laatsteMeting=Object.assign(Object.assign({},c),{location:""}),this.addLocation(l.id,c.gla,c.glo),this.organisatie=r):(r.weerstations.find(m=>m.id===l.id).laatsteMeting=null,this.organisatie=r)})})},o=>{this.toast.error("Er ging iets mis. De weerstations kunnen niet worden opgehaald.",{position:"bottom-right",dismissible:!0,autoClose:!1})})},i=>{this.authService.logout()}):this.gebruiker=void 0})}addLocation(n,i,o){this.getReverseGeocoding$=this.locationService.reverseGeocoding(i,o).subscribe(r=>{this.organisatie.weerstations.find(l=>l.id===n).laatsteMeting.location=r.address.country+(r.address.town?", "+r.address.town:"")},r=>{console.log(r),this.toast.error("Er ging iets mis.  De locatie van het weerstation kon niet worden opgehaald.",{position:"bottom-right",dismissible:!0,autoClose:!1})})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(T.e),e.Y36(C.V),e.Y36(M.n),e.Y36(h.W),e.Y36(y.a),e.Y36(x.jE))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-weerstations-organisatie-list"]],viewQuery:function(n,i){if(1&n&&e.Gf(f,7),2&n){let o;e.iGM(o=e.CRH())&&(i.weerstationActiverenComponent=o.first)}},decls:7,vars:2,consts:[["title","Weerstation activeren"],[1,"flex","row","justify-end","container","mx-auto","w-full","px-8","pt-2"],[1,"p-2","px-5","bg-transparent","border-2","border-wbRed-500","text-wbRed-500","text-md","font-bold","rounded-lg","transition-colors","duration-700","transform","hover:bg-wbRed-500","hover:text-white","mb-2",3,"click"],[4,"ngIf","ngIfElse"],["showLoading",""],["showGeenOrganisatie",""],[1,"flex","flex-col","flex-wrap","lg:flex-row","container","mx-auto","w-full","px-8"],[1,"mt-4","lg:mt-0","lg:w-3/5"],[1,"text-xl","md:text-2xl","ml-2","lg:ml-0","lg:text-3xl","font-bold","text-gray-900","tracking-normal","lg:w-11/12"],[1,"lg:w-2/5","flex","mt-10","ml-2","lg:ml-0","lg:mt-0","lg:justify-end"],[1,"pt-2","relative","text-gray-600"],["type","search","name","search","placeholder","Search",1,"focus:ring-indigo-500","border","focus:border-indigo-500","bg-white","h-10","px-5","pr-16","rounded-lg","text-sm","focus:outline-none"],["type","submit",1,"focus:ring-2","focus:ring-offset-2","text-gray-600","focus:text-indigo-700","focus:rounded-full","focus:bg-gray-100","focus:ring-indigo-700","bg-white","focus:outline-none","absolute","right-0","top-0","mt-5","mr-4"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","version","1.1","id","Capa_1","x","0px","y","0px","viewBox","0 0 56.966 56.966",0,"xml","space","preserve","width","512px","height","512px",1,"h-4","w-4","fill-current",2,"enable-background","new 0 0 56.966 56.966"],["d","M55.146,51.887L41.588,37.786c3.486-4.144,5.396-9.358,5.396-14.786c0-12.682-10.318-23-23-23s-23,10.318-23,23  s10.318,23,23,23c4.761,0,9.298-1.436,13.177-4.162l13.661,14.208c0.571,0.593,1.339,0.92,2.162,0.92  c0.779,0,1.518-0.297,2.079-0.837C56.255,54.982,56.293,53.08,55.146,51.887z M23.984,6c9.374,0,17,7.626,17,17s-7.626,17-17,17  s-17-7.626-17-17S14.61,6,23.984,6z"],[1,"w-full","grid","grid-cols-1","lg:grid-cols-2","pb-6","gap-8"],["class","bg-white border-4 border-wbRed-500 rounded-lg flex flex-col sm:flex-row",4,"ngFor","ngForOf"],[1,"bg-white","border-4","border-wbRed-500","rounded-lg","flex","flex-col","sm:flex-row"],[1,"flex","flex-col","justify-center","w-full","h-16","sm:h-auto","sm:w-32","border-b-4","sm:border-b-0","sm:border-r-4","border-wbRed-500",3,"ngClass"],["tooltip","<p>Weerstation manueel schakelen.</p>",1,"w-2","place-self-center","-translate-x-5",3,"value","color","options","change"],[1,"p-5","rounded-md","relative","h-full","w-full"],[1,"pb-4","text-2xl","font-semibold"],[1,"font-bold","cursor-pointer","flex","text-wbRed-500","float-right",3,"href"],[1,"far","fa-bell","text-2xl"],["tooltip","<p>De metingen van het weerstation zijn raadpleegbaar voor iedereen.</p>","class","px-2 inline-flex font-semibold rounded-full bg-green-100 text-green-800",3,"options",4,"ngIf","ngIfElse"],["showNietZichtbaar",""],[1,"my-2"],[1,"font-medium","text-lg"],["showGeenMeting",""],[1,"pt-3"],[1,"font-bold","hover:underline","cursor-pointer","flex","items-center","text-wbRed-500",3,"href"],[1,"ml-2","fas","fa-arrow-right"],["tooltip","<p>De metingen van het weerstation zijn raadpleegbaar voor iedereen.</p>",1,"px-2","inline-flex","font-semibold","rounded-full","bg-green-100","text-green-800",3,"options"],["tooltip","<p>De metingen van het weerstation zijn enkel raadpleegbaar voor organisatie leden.</p>",1,"px-2","inline-flex","font-semibold","rounded-full","bg-orange-100","text-orange-800",3,"options"],["showLaatsteGegevens",""],[1,"fas","fa-circle-notch","fa-spin","mr-2","text-wbRed-500","text-2xl","text-center"],[1,"font-medium","mr-1"],["class","px-2 inline-flex font-semibold rounded-full bg-green-100 text-green-800",4,"ngIf","ngIfElse"],["showUit",""],[1,"px-2","inline-flex","font-semibold","rounded-full","bg-green-100","text-green-800"],[1,"px-2","inline-flex","font-semibold","rounded-full","bg-red-100","text-red-800"],[1,"w-8/12","bg-gray-300","h-10","rounded-full","animate-pulse","mb-1"],[1,"pt-2","relative"],[1,"w-6/12","bg-gray-300","h-4","rounded-full","animate-pulse","mb-1"],["class","bg-gray-300 h-72 rounded-lg animate-pulse mb-1",4,"ngFor","ngForOf"],[1,"bg-gray-300","h-72","rounded-lg","animate-pulse","mb-1"]],template:function(n,i){if(1&n&&(e._UZ(0,"app-weerstations-activeren",0),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(){return i.weerstationActiveren()}),e._uU(3," Weerstation activeren "),e.qZA(),e.qZA(),e.YNc(4,F,4,2,"ng-container",3),e.YNc(5,G,8,2,"ng-template",null,4,e.W1O)),2&n){const o=e.MAs(6);e.xp6(4),e.Q6J("ngIf",!i.loading)("ngIfElse",o)}},directives:[f,d.O5,d.sg,d.mk,O.sX,W.i9],pipes:[d.uU],styles:[""]}),t})();var H=a(7740);const X=[{path:"weerstations",component:B},{path:"weerstationactiveren",component:f},{path:"waardes/:id",component:H.w}];let P=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[p.Bz.forChild(X)],p.Bz]}),t})()}}]);