<p>laat een list zien van alle weerstations</p>

<p>als ADMIN zie je alle weerstations van alle organisaties</p>
<p>als ORG ADMIN zie je alle weerstations van jouw organisatie</p>
<p>bewerken gaat naar weerstation-form component</p>
<p>toevoegen gaat naar weerstation-activeren component</p>
<br>

<div class="alert alert-danger" role="alert" *ngIf="errorMessage">
    {{errorMessage}}
</div>
<button type="button" class="btn btn-success addBtn float-right" (click)="add()"><i class="fas fa-plus"></i> Weerstation
    toevoegen</button>
<br>
<div *ngFor="let organisatie of organisaties" class="mb-2">
    <div>
        <div class="text-sm font-bold mb-1">
            {{organisatie.naam}}
        </div>
        <div *ngFor="let weerstation of organisatie.weerstations" class="grid grid-cols-12 ml-5">
            <div class="col-span-5 text-xs">
                <form (ngSubmit)="handleSubmit($event)">
                    <label (click)="changeNaam(weerstation.id, weerstation.naam)" *ngIf="(weerstation.id !== changeNaamId)"
                    for="{{weerstation.id}}">
                    {{weerstation.naam}}
                </label>
                    <input class="border border-black w-11/12 rounded-sm" type="text" value="{{weerstation.naam}}" *ngIf="(weerstation.id === changeNaamId)" id="{{weerstation.id}}" (keyup)="handleKeyUp($event)" name="{{weerstation.id}}" [(ngModel)]="naam">
                </form>
            </div>

            <div class="col-span-3 text-xs">
                <!-- <label *ngIf='(weerstation.isPubliekZichtbaar == 1)' class="toggle" for="{{weerstation.id}}">
                    <input (change)="changeZichtbaarheid(weerstation)" type="checkbox" class="" checked id="{{weerstation.id}}" />
                    {{weerstation.isPubliekZichtbaar == 1 ? "zichtbaar" : "niet zichtbaar"}}
                </label>
                <label *ngIf='(weerstation.isPubliekZichtbaar != 1)' class="toggle" for="{{weerstation.id}}">
                    <input (change)="changeZichtbaarheid(weerstation)" type="checkbox" class="" id="{{weerstation.id}}" />
                    {{weerstation.isPubliekZichtbaar == 1 ? "zichtbaar" : "niet zichtbaar"}}
                </label> -->
                <ng-toggle [value]="weerstation.isPubliekZichtbaar == 1 ? true : false"
                    [color]="{ unchecked: '#DDDEE3', checked: '#73D673'}" (change)="changeZichtbaarheid(weerstation)"
                    class="w-2"></ng-toggle>
                <div class="inline">
                    {{weerstation.isPubliekZichtbaar == 1 ? "zichtbaar" : "niet zichtbaar"}}
                </div>
            </div>
            <div class="col-span-1 m-auto cursor-pointer" routerLink="/waardes" routerLinkActive="active"
                [routerLinkActiveOptions]="{ exact: true }"
                tooltip="<p class='text-xs'>edit alarm- en schakelwaardes</p>"
                [options]="{placement: 'top', hideDelay: 20}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M10.1461 3.24812C10.4433 2.51616 11.1614 2 12 2C12.8386 2 13.5567 2.51616 13.8539 3.24812C16.8202 4.06072 19 6.77579 19 10V14.6972L20.8321 17.4453C21.0366 17.7522 21.0557 18.1467 20.8817 18.4719C20.7077 18.797 20.3688 19 20 19H15.4646C15.2219 20.6961 13.7632 22 12 22C10.2368 22 8.77806 20.6961 8.53545 19H4C3.63121 19 3.29235 18.797 3.11833 18.4719C2.94431 18.1467 2.96338 17.7522 3.16795 17.4453L5 14.6972V10C5 6.77579 7.17983 4.06072 10.1461 3.24812ZM10.5854 19C10.7913 19.5826 11.3469 20 12 20C12.6531 20 13.2087 19.5826 13.4146 19H10.5854ZM12 5C9.23858 5 7 7.23858 7 10V15C7 15.1974 6.94156 15.3904 6.83205 15.5547L5.86852 17H18.1315L17.168 15.5547C17.0584 15.3904 17 15.1974 17 15V10C17 7.23858 14.7614 5 12 5Z"
                        fill="#0D0D0D" />
                </svg>
            </div>
            <div class="col-span-1 m-auto cursor-pointer" routerLink="/dashboard" routerLinkActive="active"
                [routerLinkActiveOptions]="{ exact: true }" tooltip="<p class='text-xs'>Dashboard</p>"
                [options]="{placement: 'top', hideDelay: 20}">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M3 5C3 3.89543 3.89543 3 5 3H19C20.1046 3 21 3.89543 21 5V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V5ZM19 5H5V19H19V5ZM12 7C12.5523 7 13 7.44772 13 8V16C13 16.5523 12.5523 17 12 17C11.4477 17 11 16.5523 11 16V8C11 7.44772 11.4477 7 12 7ZM16 9C16.5523 9 17 9.44772 17 10V16C17 16.5523 16.5523 17 16 17C15.4477 17 15 16.5523 15 16V10C15 9.44772 15.4477 9 16 9ZM8 11C8.55228 11 9 11.4477 9 12V16C9 16.5523 8.55228 17 8 17C7.44772 17 7 16.5523 7 16V12C7 11.4477 7.44772 11 8 11Z"
                        fill="#0D0D0D" />
                </svg>
            </div>
            <div class="col-span-1 m-auto cursor-pointer" tooltip="<p class='text-xs'>Edit {{weerstation.naam}}</p>"
                [options]="{placement: 'top', hideDelay: 20}" (click)=edit(weerstation.id)>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M16.2929 2.29289C16.6834 1.90237 17.3166 1.90237 17.7071 2.29289L21.7071 6.29289C22.0976 6.68342 22.0976 7.31658 21.7071 7.70711L8.70711 20.7071C8.51957 20.8946 8.26522 21 8 21H4C3.44772 21 3 20.5523 3 20V16C3 15.7348 3.10536 15.4804 3.29289 15.2929L13.2927 5.2931L16.2929 2.29289ZM14 7.41421L5 16.4142V19H7.58579L16.5858 10L14 7.41421ZM18 8.58579L19.5858 7L17 4.41421L15.4142 6L18 8.58579Z"
                        fill="#0D0D0D" />
                </svg>
            </div>
            <div class="col-span-1 m-auto cursor-pointer text-sm" (click)="deleteWeerstation(weerstation.id)"
                tooltip="<p class='text-xs'>Delete {{weerstation.naam}}</p>"
                [options]="{placement: 'top', hideDelay: 20}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M7 4C7 2.89543 7.89543 2 9 2H15C16.1046 2 17 2.89543 17 4V6H18.9897C18.9959 5.99994 19.0021 5.99994 19.0083 6H21C21.5523 6 22 6.44772 22 7C22 7.55228 21.5523 8 21 8H19.9311L19.0638 20.1425C18.989 21.1891 18.1182 22 17.0689 22H6.93112C5.88184 22 5.01096 21.1891 4.9362 20.1425L4.06888 8H3C2.44772 8 2 7.55228 2 7C2 6.44772 2.44772 6 3 6H4.99174C4.99795 5.99994 5.00414 5.99994 5.01032 6H7V4ZM9 6H15V4H9V6ZM6.07398 8L6.93112 20H17.0689L17.926 8H6.07398Z"
                        fill="red" />
                </svg>
            </div>

        </div>
    </div>
</div>
<div class="text-sm font-bold mb-1">
    Nog niet geactiveerd
</div>
<div *ngFor="let weerstation of weerstationsZonderOrganisatie">
    <p>{{weerstation.naam}}</p>
    <p>{{weerstation.gsmNummer}}</p>
    <p>{{weerstation.uniekeCode}}</p>
    <hr>
    <br>
</div>

<div class="flex row justify-end">
    <button (click)="add()"
        class="p-2 px-5 bg-transparent border-2 border-indigo-600 text-indigo-600 text-md font-bold rounded-lg transition-colors duration-700 transform hover:bg-indigo-600 hover:text-gray-100 mb-2">
        Weerstation toevoegen
    </button>
</div>

<h2 class="text-2xl font-bold mb-2">Weerstations zonder organisatie</h2>
<div class="flex flex-col mb-10">
    <div class="-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
        <div class="py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8">
            <div class="shadow overflow-hidden border-b border-gray-200 sm:rounded-lg">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col"
                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Naam
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Gsm nummer
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Activatie code <i class="far fa-question-circle text-base" tooltip="<p class='text-xs'>Hiermee kan een weerstation toegevoegd worden aan een organisatie.</p>" [options]="{placement: 'top', hideDelay: 20}"></i>
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Publiek zichtbaar <i class="far fa-question-circle text-base" tooltip="<p class='text-xs'>Zijn de metingen van het weerstation beschikbaar voor iedereen.</p>" [options]="{placement: 'top', hideDelay: 20}"></i>
                            </th>
                            <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Dashboard
                            </th>
                            <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Alarm- en Schakelwaarden
                            </th>
                            <th scope="col"
                                class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Acties
                            </th>
                        </tr>
                    </thead>
                    <tbody *ngIf="loading">
                        <tr *ngFor="let n of [1, 2, 3]">
                            <td class="px-6 py-4">
                                <div class="w-10/12 bg-gray-300 h-4 rounded-full animate-pulse mb-1"></div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="w-8/12 bg-gray-300 h-4 rounded-full animate-pulse mb-1"></div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="w-6/12 bg-gray-300 h-4 animate-pulse mb-1"></div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="w-6/12 bg-gray-300 h-4 rounded-full animate-pulse mb-1"></div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="flex justify-around">
                                    <div class="w-4 bg-gray-300 h-4 rounded-sm animate-pulse mb-1"></div>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="flex justify-around">
                                    <div class="w-4 bg-gray-300 h-4 rounded-sm animate-pulse mb-1"></div>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="flex justify-around">
                                    <div class="w-3/12 bg-gray-300 h-4 rounded-full animate-pulse mr-1"></div>
                                    <div class="w-4/12 bg-gray-300 h-4 rounded-full animate-pulse"></div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                    <tbody *ngIf="!loading" class="bg-white divide-y divide-gray-200">
                        <!-- Row voor elk weerstation zonder organisatie -->
                        <tr *ngFor="let weerstation of weerstationsZonderOrganisatie">
                            <td class="px-6 py-4 whitespace-nowrap text-sm">
                                {{ weerstation.naam }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm">
                                {{ weerstation.gsmNummer }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm">
                                <span class="bg-black hover:bg-gray-200 cursor-pointer" tooltip="<p class='text-xs'>Klik om te kopiÃ«ren</p>" [options]="{placement: 'top', hideDelay: 20}" (click)="copyCode(weerstation.uniekeCode)">{{ weerstation.uniekeCode }}</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm">
                                <span *ngIf="weerstation.isPubliekZichtbaar; else showNietZichtbaar"
                                    class="px-2 inline-flex font-semibold rounded-full bg-green-100 text-green-800">Zichtbaar</span>
                                <ng-template #showNietZichtbaar>
                                    <span class="px-2 inline-flex font-semibold rounded-full bg-orange-100 text-orange-800">
                                        Niet zichtbaar
                                    </span>
                                </ng-template>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm">
                                <div class="flex justify-around">
                                    <a href="" tooltip="<p class='text-xs'>Dashboard bekijken</p>" [options]="{placement: 'top', hideDelay: 20}"><i class="far fa-chart-bar text-2xl"></i></a>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm">
                                <div class="flex justify-around">
                                    <a href="" tooltip="<p class='text-xs'>Alarm- en Schakelwaarden wijzigen</p>" [options]="{placement: 'top', hideDelay: 20}"><i class="far fa-bell text-2xl"></i></a>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <div class="flex justify-around">
                                    <a class="text-indigo-600 hover:text-indigo-900 cursor-pointer mr-1 sm:mr-0"
                                        (click)="wijzigWeerstationZonderOrganisatie(weerstation.id)">Wijzig</a>
                                    <a class="text-indigo-600 hover:text-indigo-900 cursor-pointer ml-1 sm:ml-0"
                                        (click)="verwijderWeerstation(weerstation.id)">Verwijder</a>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<h2 class="text-2xl font-bold mb-2">Weerstations van organisatie</h2>
<div class="flex flex-col">
    <div class="-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
        <div class="py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8">
            <div class="shadow overflow-hidden border-b border-gray-200 sm:rounded-lg">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col"
                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Naam
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Gsm nummer
                            </th>
                            <th scope="col"
                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Publiek zichtbaar <i class="far fa-question-circle text-base" tooltip="<p class='text-xs'>Zijn de metingen van het weerstation beschikbaar voor iedereen.</p>" [options]="{placement: 'top', hideDelay: 20}"></i>
                            </th>
                            <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Dashboard
                            </th>
                            <th scope="col"
                                class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Alarm- en Schakelwaarden
                            </th>
                            <th scope="col"
                                class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Acties
                            </th>
                        </tr>
                    </thead>
                    <tbody *ngIf="loading">
                        <tr *ngFor="let n of [1, 2, 3]">
                            <td class="px-6 py-4">
                                <div class="w-10/12 bg-gray-300 h-4 rounded-full animate-pulse mb-1"></div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="w-10/12 bg-gray-300 h-4 rounded-full animate-pulse mb-1"></div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="w-6/12 bg-gray-300 h-4 rounded-full animate-pulse mb-1"></div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="flex justify-around">
                                    <div class="w-4 bg-gray-300 h-4 rounded-sm animate-pulse mb-1"></div>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="flex justify-around">
                                    <div class="w-4 bg-gray-300 h-4 rounded-sm animate-pulse mb-1"></div>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="flex justify-around">
                                    <div class="w-3/12 bg-gray-300 h-4 rounded-full animate-pulse mr-1"></div>
                                    <div class="w-4/12 bg-gray-300 h-4 rounded-full animate-pulse"></div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                    <tbody *ngIf="!loading" class="bg-white divide-y divide-gray-200">
                        <!-- Row voor elk weerstation van een organisatie -->
                        <ng-container *ngFor="let organisatie of organisaties">
                            <tr>
                                <td colspan="4" class="px-6 py-4 whitespace-nowrap">
                                    <div class="font-bold text-gray-900">
                                        {{ organisatie.naam }} <span class="font-normal text-sm">({{organisatie.weerstations.length}} weerstations)</span>
                                    </div>
                                </td>
                            </tr>
                            <tr *ngFor="let weerstation of organisatie.weerstations">
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    {{ weerstation.naam }}
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    {{ weerstation.gsmNummer }}
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span *ngIf="weerstation.isPubliekZichtbaar; else showNietZichtbaar" class="px-2 inline-flex font-semibold rounded-full bg-green-100 text-green-800">Zichtbaar</span>
                                    <ng-template #showNietZichtbaar>
                                        <span class="px-2 inline-flex font-semibold rounded-full bg-orange-100 text-orange-800">
                                            Niet zichtbaar
                                        </span>
                                    </ng-template>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <div class="flex justify-around">
                                        <a href="" tooltip="<p class='text-xs'>Dashboard bekijken</p>" [options]="{placement: 'top', hideDelay: 20}"><i
                                                class="far fa-chart-bar text-2xl"></i></a>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <div class="flex justify-around">
                                        <a href="" tooltip="<p class='text-xs'>Alarm- en Schakelwaarden wijzigen</p>"
                                            [options]="{placement: 'top', hideDelay: 20}"><i class="far fa-bell text-2xl"></i></a>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <div class="flex justify-around">
                                        <a class="text-indigo-600 hover:text-indigo-900 cursor-pointer mr-1 sm:mr-0"
                                            (click)="wijzigWeerstationOrganisatie(weerstation.id)">Wijzig</a>
                                        <a class="text-indigo-600 hover:text-indigo-900 cursor-pointer ml-1 sm:ml-0"
                                            (click)="verwijderWeerstation(weerstation.id)">Verwijder</a>
                                    </div>
                                </td>
                            </tr>
                        </ng-container>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>



<a routerLink="/dashboard" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">Back</a>